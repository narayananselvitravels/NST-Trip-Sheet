<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NST Trip Sheet</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://gomapspro.com/autocomplete.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #f9f9f9;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }
    h2 {
      color: #4b2aad;
      text-align: center;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: 600;
    }
    input, select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 15px;
      font-size: 15px;
    }
    button {
      background: #4b2aad;
      color: white;
      padding: 12px 18px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
    }
    button:hover {
      background: #381f86;
    }
  </style>
</head>
<body>

<h2>üìù NST Trip Sheet</h2>

<form id="tripForm">
  <label for="tripDate">Date</label>
  <input type="date" id="tripDate" required />

  <label for="pickup">Pickup Location</label>
  <input id="pickup" type="text" placeholder="Enter pickup location" class="gomaps-autocomplete" data-api-key="AlzaSyfFRhudoF6Hm2OtxpMDIT4CxwZ3FJvEMZV" required>

  <label for="drop">Drop Location</label>
  <input id="drop" type="text" placeholder="Enter drop location" class="gomaps-autocomplete" data-api-key="AlzaSyfFRhudoF6Hm2OtxpMDIT4CxwZ3FJvEMZV" required>

  <label for="driverName">Driver Name</label>
  <select id="driverName" required></select>

  <label for="driverNumber">Driver Number</label>
  <select id="driverNumber" required></select>

  <label for="vehicleModel">Vehicle Model</label>
  <select id="vehicleModel" required></select>

  <label for="vehicleNo">Vehicle Number</label>
  <select id="vehicleNo" required></select>

  <label for="extraHours">Extra Hours</label>
  <input type="number" id="extraHours" placeholder="Enter extra hours manually" min="0">

  <label for="extraKM">Extra KM</label>
  <input type="number" id="extraKM" placeholder="Enter extra KM manually" min="0">

  <label for="totalAmount">Total Amount (‚Çπ)</label>
  <input type="number" id="totalAmount" placeholder="Enter total amount" min="0">

  <label for="paymentStatus">Payment Status</label>
  <select id="paymentStatus">
    <option value="Paid">Paid</option>
    <option value="Not Paid">Not Paid</option>
  </select>

  <button type="submit">üíæ Save Trip</button>
</form>

<script>
  const driverDataKey = "drivers";
  const vehicleDataKey = "vehicles";

  function loadMasterData() {
    const driverNameSelect = document.getElementById("driverName");
    const driverNumberSelect = document.getElementById("driverNumber");
    const vehicleModelSelect = document.getElementById("vehicleModel");
    const vehicleNoSelect = document.getElementById("vehicleNo");

    const drivers = JSON.parse(localStorage.getItem(driverDataKey) || "[]");
    const vehicles = JSON.parse(localStorage.getItem(vehicleDataKey) || "[]");

    driverNameSelect.innerHTML = `<option>-- Select --</option>`;
    driverNumberSelect.innerHTML = `<option>-- Select --</option>`;
    drivers.forEach(d => {
      driverNameSelect.innerHTML += `<option value="${d.name}">${d.name}</option>`;
      driverNumberSelect.innerHTML += `<option value="${d.number}">${d.number}</option>`;
    });

    vehicleModelSelect.innerHTML = `<option>-- Select --</option>`;
    vehicleNoSelect.innerHTML = `<option>-- Select --</option>`;
    vehicles.forEach(v => {
      vehicleModelSelect.innerHTML += `<option value="${v.model}">${v.model}</option>`;
      vehicleNoSelect.innerHTML += `<option value="${v.number}">${v.number}</option>`;
    });

    driverNameSelect.addEventListener("change", () => {
      const selected = drivers.find(d => d.name === driverNameSelect.value);
      driverNumberSelect.value = selected ? selected.number : "";
    });

    driverNumberSelect.addEventListener("change", () => {
      const selected = drivers.find(d => d.number === driverNumberSelect.value);
      driverNameSelect.value = selected ? selected.name : "";
    });

    vehicleModelSelect.addEventListener("change", () => {
      const selected = vehicles.find(v => v.model === vehicleModelSelect.value);
      vehicleNoSelect.value = selected ? selected.number : "";
    });

    vehicleNoSelect.addEventListener("change", () => {
      const selected = vehicles.find(v => v.number === vehicleNoSelect.value);
      vehicleModelSelect.value = selected ? selected.model : "";
    });
  }

  document.getElementById("tripForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const trip = {
      date: tripDate.value,
      pickup: pickup.value,
      drop: drop.value,
      driverName: driverName.value,
      driverNumber: driverNumber.value,
      vehicleModel: vehicleModel.value,
      vehicleNo: vehicleNo.value,
      extraHours: extraHours.value,
      extraKM: extraKM.value,
      totalAmount: totalAmount.value,
      paymentStatus: paymentStatus.value
    };
    console.log("Trip saved:", trip);
    alert("‚úÖ Trip saved successfully! (Not stored permanently in this version)");
    this.reset();
  });

  loadMasterData();
</script>

</body>
</html>
