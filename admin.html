<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><title>Admin â€“ NST</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body{font-family:Poppins,sans-serif;padding:20px;max-width:600px;margin:auto;background:#f4f6f9;}
    h2{color:#4b2aad;}button{padding:10px;margin:10px 0;border:none;color:white;cursor:pointer;border-radius:5px;}
    button.export{background:#4b2aad;}button.reset{background:#dc3545;}
  </style>
</head>
<body>
<h2>ğŸ› ï¸ Admin Panel â€“ NST</h2>

<p><strong>Total Trips Shared:</strong> <span id="count">0</span></p>
<p><strong>Next Trip ID:</strong> <span id="next">#NST001</span></p>

<button class="export" onclick="exportTrips()">ğŸ“¥ Export All Trips (Excel)</button><br>
<button class="reset danger" onclick="resetAll()">ğŸ—‘ï¸ Reset All Data</button>

<script>
function loadTrips(){return JSON.parse(localStorage.getItem("shared-trips")||"[]");}
function loadSeq(){return parseInt(localStorage.getItem("trip-seq")||"1");}

function updateStats(){
  const t = loadTrips(), seq=loadSeq();
  count.innerText = t.length;
  next.innerText = "#NST"+String(seq).padStart(3,"0");
}
function exportTrips(){
  const arr = loadTrips();
  if(!arr.length)return alert("No trips to export.");
  const wb=XLSX.utils.book_new(),
        ws=XLSX.utils.json_to_sheet(arr);
  XLSX.utils.book_append_sheet(wb,ws,"Trips");
  XLSX.writeFile(wb,"NST_Shared_Trips.xlsx");
}
function resetAll(){
  if(!confirm("Erase all trips and reset?"))return;
  localStorage.removeItem("shared-trips");
  localStorage.removeItem("trip-seq");
  Object.keys(localStorage).filter(k=>k.startsWith("#NST")).forEach(k=>localStorage.removeItem(k));
  updateStats();
  alert("âœ… System reset");
}

updateStats();
</script>
</body>
</html>
