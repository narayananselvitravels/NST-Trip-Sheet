<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NST Trip Sheet</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #f4f6f9;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }
    label { font-weight: 600; margin-top: 10px; display: block; }
    input, select, textarea, button {
      width: 100%; padding: 10px; margin: 5px 0 15px 0;
      border: 1px solid #ccc; border-radius: 5px; font-size: 16px;
    }
    button { background: #4b2aad; color: white; border: none; cursor: pointer; }
    button:hover { background: #3b2390; }
    .btn-group { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
    #printContent { display: none; }
    .invoice {
      background: white; width: 210mm; min-height: 297mm;
      margin: auto; padding: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .header { text-align: center; margin-bottom: 10px; }
    .header h1 { color: #4b2aad; margin: 0; font-size: 26px; }
    .invoice-meta, .two-column {
      display: flex; justify-content: space-between; flex-wrap: wrap; gap: 10px;
    }
    .invoice-meta { margin-bottom: 15px; font-weight: 600; }
    .section { margin-bottom: 15px; }
    .section h2 {
      background: #4b2aad; color: white; padding: 6px 10px;
      margin: 0; border-radius: 4px 4px 0 0;
    }
    .section .content {
      border: 1px solid #4b2aad; padding: 10px; border-radius: 0 0 4px 4px;
    }
    .label { font-weight: 600; margin-top: 5px; }
    table {
      width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px;
    }
    table th, table td {
      border: 1px solid #4b2aad; padding: 6px;
    }
    table th { background: #4b2aad; color: white; }
    .total { text-align: right; font-size: 15px; font-weight: bold; margin-top: 10px; }
    .signatures {
      display: flex; justify-content: space-between; margin-top: 30px;
    }
    .footer {
      text-align: center; font-size: 14px; margin-top: 20px; font-weight: 600;
    }
    .footer span { color: #4b2aad; }
  </style>
</head>
<body>  <h2>üìù NST Trip Sheet</h2>
  <div>
    <label>Trip ID</label><input id="tripId" readonly>
    <label>Date</label><input type="date" id="tripDate">
    <label>Customer Name</label><input id="custName">
    <label>Customer Number</label><input id="custNumber">
    <label>Driver Name</label><input id="driverName">
    <label>Driver Number</label><input id="driverNumber">
    <label>Vehicle Model</label><input id="vehicleModel">
    <label>Vehicle Number</label><input id="vehicleNo">
    <label>Start Time</label><input type="time" id="startTime">
    <label>End Time</label><input type="time" id="endTime">
    <label>Duration (hrs)</label><input id="duration" readonly>
    <label>Extra Hours</label><input id="extraHours" readonly>
    <label>Start KM</label><input type="number" id="startKM">
    <label>End KM</label><input type="number" id="endKM">
    <label>Total KM</label><input id="totalKM" readonly>
    <label>Extra KM</label><input id="extraKM" readonly>
    <label>Package ‚Çπ</label><input id="packageCost">
    <label>Extra Hr ‚Çπ</label><input id="extraHrCost">
    <label>Extra KM ‚Çπ</label><input id="extraKmCost">
    <label>Toll ‚Çπ</label><input id="toll">
    <label>Parking ‚Çπ</label><input id="parking">
    <label>Total ‚Çπ</label><input id="totalCost" readonly>
    <label>Note</label><input id="note">
  </div>  <div class="btn-group">
    <button onclick="exportPDF()">üìÑ Export PDF</button>
  </div>  <div id="printContent"></div>  <script>
    function to12Hr(timeStr) {
      const [h, m] = timeStr.split(":");
      let hour = parseInt(h);
      let suffix = hour >= 12 ? "PM" : "AM";
      hour = hour % 12 || 12;
      return `${hour}:${m} ${suffix}`;
    }

    function formatDate(dateStr) {
      if (!dateStr) return "";
      const d = new Date(dateStr);
      return `${String(d.getDate()).padStart(2, '0')}-${String(d.getMonth() + 1).padStart(2, '0')}-${d.getFullYear()}`;
    }

    function exportPDF() {
      const t = {
        id: tripId.value,
        date: tripDate.value,
        cust: custName.value,
        custNum: custNumber.value,
        driver: driverName.value,
        driverNum: driverNumber.value,
        model: vehicleModel.value,
        no: vehicleNo.value,
        start: startTime.value,
        end: endTime.value,
        duration: duration.value,
        extraHr: extraHours.value,
        startKM: startKM.value,
        endKM: endKM.value,
        totalKM: totalKM.value,
        extraKM: extraKM.value,
        pkg: packageCost.value,
        hrCost: extraHrCost.value,
        kmCost: extraKmCost.value,
        toll: toll.value,
        park: parking.value,
        total: totalCost.value,
        note: note.value
      };
      const printDiv = document.getElementById("printContent");
      printDiv.innerHTML = `
      <div class="invoice">
        <div class="header">
          <h1>NST Travels</h1>
          <p>Premium Taxi Invoice</p>
        </div>
        <div class="invoice-meta">
          <div><strong>Invoice No:</strong> ${t.id}</div>
          <div><strong>Date:</strong> ${formatDate(t.date)}</div>
        </div>
        <div class="section">
          <h2>Passenger & Driver Details</h2>
          <div class="content two-column">
            <div>
              <div class="label">Customer Name</div>${t.cust}
              <div class="label">Customer Mobile</div>${t.custNum}
              <div class="label">Owner Name</div>N. Sivakumar
              <div class="label">Owner Mobile</div>98988988888
            </div>
            <div>
              <div class="label">Driver Name</div>${t.driver}
              <div class="label">Driver Mobile</div>${t.driverNum}
              <div class="label">Vehicle Model</div>${t.model}
              <div class="label">Vehicle Number</div>${t.no}
            </div>
          </div>
        </div>
        <div class="section">
          <h2>Trip Info</h2>
          <div class="content two-column">
            <div>
              <div class="label">Start Time</div>${to12Hr(t.start)}
              <div class="label">Trip Date</div>${formatDate(t.date)}
            </div>
            <div>
              <div class="label">End Time</div>${to12Hr(t.end)}
              <div class="label">Trip Duration</div>${t.duration} hrs (${t.extraHr} extra)
            </div>
          </div>
        </div>
        <div class="section">
          <h2>Billing Summary</h2>
          <div class="content">
            <table>
              <thead><tr><th>Description</th><th>Rate</th><th>Units</th><th>Amount</th></tr></thead>
              <tbody>
                <tr><td>Package</td><td>‚Çπ${t.pkg}</td><td>Fixed</td><td>‚Çπ${t.pkg}</td></tr>
                <tr><td>Extra Hours</td><td>‚Çπ${t.hrCost}</td><td>${t.extraHr} hrs</td><td>‚Çπ${t.hrCost}</td></tr>
                <tr><td>Extra KM</td><td>‚Çπ${t.kmCost}</td><td>${t.extraKM} km</td><td>‚Çπ${t.kmCost}</td></tr>
                <tr><td>Toll Charges</td><td>-</td><td>-</td><td>‚Çπ${t.toll}</td></tr>
                <tr><td>Parking Charges</td><td>-</td><td>-</td><td>‚Çπ${t.park}</td></tr>
              </tbody>
            </table>
            <div class="total">Total Fare: ‚Çπ${t.total}</div>
          </div>
        </div>
        <div class="signatures">
          <div>_____________________<br>Customer Signature</div>
          <div>_____________________<br>Authorized Signature</div>
        </div>
        <div class="footer">
          üòä <span>Happy Ride!</span> Thanks for choosing <strong>NST Travels üöñ</strong>
        </div>
      </div>`;

      setTimeout(() => {
        html2canvas(printDiv.querySelector(".invoice")).then(canvas => {
          const imgData = canvas.toDataURL('image/png');
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const width = 210;
          const height = (canvas.height * width) / canvas.width;
          pdf.addImage(imgData, 'PNG', 0, 0, width, height);
          pdf.save(`${t.id}.pdf`);
        });
      }, 300);
    }
  </script></body>
</html>